#+TITLE: Images des Mathématiques --- technical documentation

This documents the /squelette/ of the website at
http://images.math.cnrs.fr/ and complements the documentation there
(which is mainly addressed at article authors and editors --- this one
is full of SPIP ang PHP and geek stuff).

* Code management
This is done in Git, and there are 4 branches to keep track of (plus
temporary ones for experimental features, if needed). That can change if
we end up working in a team but so far:
- =spip3= is tracking the SVN version of the SPIP core (without
  extensions)
- =upstream= incorporates the extensions, and merges =spip3=
  periodically (meaning whenever a bug is fixed there)
- =idm= is the current status of the website, and merges =upstream= when
  needed
- =test= is for development of new but "easy" features, and is typically
  merged into =idm= the same day

* Issues
*** Urgent
- Find a style for the Courrier
- Use the Partenariats keywords
*** In progress
- [CSS] Merge =div.plan= and =div.lexique=
- Overhaul of the search engine
- iPhone version [25%]
  - [X] Basic iphone.html
  - [ ] Specific style for small screens (it used to work using
    =max-width=, but apparently that breaks older browsers ...)
  - [ ] Automatic suggestion
  - [ ] Find a way to make login etc. possible
- One year ago on IdM [33%]
  - [X] Create the page, basic functionality
  - [ ] Merge it with =sommaire.html= for maintainability
  - [ ] Merge the system with the color filtering ?
*** Next
- CC per article
- Loop videos
- Make the billets visually different
- Upgrade Mathjax [0%]
  - [ ] Wait for label/ref to be in mainline mathjax
  - [ ] Wait for it to be in a stable release
  - [ ] Remove the previous hack
- Choose the member in the billets team differently
- =squelettes/propose.html=
  - Add an anchor to the forum messages for linking
- =squelettes/navigation.html=
  - should be re-done completely
- re-install =forms_et_tables= (3.0, doesn't work yet)
*** Backburner
- Buttons to write to groups of people
- Filter display by color
- Floating picture
- Relecteur occasionnel
- Translation encouragement
- Unify the permissions
- Put =#SPIP_CRON= on specific pages but not on =sommaire.html=
- Use =#HTTP_HEADER= rather than php in =inc/head.php=
- Merge =inc/forum-message= and =inc/forum-message-prive=
- In =formulaires/relecteurs_vote.php=, the SQL update code should be
  elsewhere, the rest should go
*** Geekeries and SPIPeries
- In a loop, =#_parent:TITRE=
- pipeline =jquery_plugins=
#+begin_src php
  function XXX_jquery_plugins($scripts) {
    $scripts[] = "js/bla.js";
    return $scripts;
  }
#+end_src
- plugin =spip-bonux=
  - [ ] =#INFO_TITRE{article,324}=
- Refactor uses of =idm_notify= [75%]
  - [X] Accept an array as recipient
  - [X] Call it with an array when possible
  - [X] Store recipient lists in a config file
  - [ ] Solve the problem that =config/mes_options.html= is not read during AJAX calls
- =prive/squelettes/contenu/idm_relecteur.html=
  - Make the relecteur an "objet éditorial" ?
- Files which are patched versions of upstream (store as a patch for upgrades)
  - =.htaccess= (from =htaccess.txt=)
  - =formulaires/inc-forum_previsu.html=
  - =prive/objets/infos/article.html=
- Use the =|unique= filter instead of doing it by hand
  - =squelettes/iphone.html=
  - =squelettes/lexique.html=
